<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>simply eva </title>
		<script type="text/javascript" src="d3.v3.min.js"></script>
		<style type="text/css">
		
			.axis path,
			/*.axis line {
				fill: none;
				stroke: black;
				shape-rendering: crispEdges;
			}*/
			
			.axis text {
				font-family: sans-serif;
				font-size: 11px;
			}
			.axis path{
			  fill: none;
			  stroke: black;
			  stroke-width: 1.5;
			} 

			.axis line{
			  fill: none;
			  stroke: black;
			  stroke-opacity: .25;
			  stroke-dasharray: 4,1;
			  stroke-width: 1;
			  shape-rendering: crispEdges;
			}  

			.axis minor{
			  fill: none;
			  stroke: red;
			  stroke-width: 1;
			} 

			.grid path {
				stroke-width: 0;
			}




			/* No style rules here yet */		
		

		</style>
	</head>
	<body>
		<script type="text/javascript">

			//Width and height
			var w = 1280; //total svg size
			var h = 700;

			var w1 = w; // containers for each chart
			var h1 = h/3;
			var w2 = w;
			var h2 = h/3;
			var w3 = w;
			var h3 = h/3;

			var paddingH = 50;
			var paddingV = 60;

			var dataset = [ 0, 10, 13, 19, 21, 25, 22, 18, 15, 13,
							11, 12, 15, 20, 18, 17, 0, 18, 23, 0 ];

			//Create SVG element
			var svg = d3.select("body")
						.append("svg")
						.attr("width", w)
						.attr("height", h);
		

/////////////////////////////////////////////////////////////
			function type(d) {
				d.Date = parseDate(d.Date);
				d.PD = +d.PD;
				d.ReadedPlots = +d.ReadedPlots;
				d.SUCmeanDelay = +d.SUCmeanDelay;
				return d;
			};
			//read the csv
			var parseDate = d3.time.format("%Y-%m-%d %H:%M").parse;
			//var datasetDates = [];
			//var datasetPD = [];
			/*var dataset = {
				PD: [],
				Dates: []
			};*/

			d3.csv("statistics.csv",type, function(error,data) {
				//for (e in data){
				//console.log(data[e].PD, data[e].Date);
				//csvData = data;
				//dataset.Dates.push(data[e].Date);
				//dataset.PD.push(data[e].PD);
				//}
				//return datasetPD, datasetDates;
			//});

				data.Date =data.map(function (d) { return d.Date; });
				data.PD = data.map(function (d) { return d.PD; });
				data.ReadedPlots = data.map(function (d) { return d.ReadedPlots; });
				data.SUCmeanDelay = data.map(function (d) { return d.SUCmeanDelay; });

			//console.log(dataset.PD);

////////////////////////////////////////////////////////////



			//var xScale1 = d3.scale.ordinal()
			//				.domain(d3.range(dataset.length))
			//				.rangePoints([0 + padding, w1-padding], 0.0);
			var xScale1 = d3.time.scale()
							.range([0+paddingH, w1-paddingH])
							.domain([data.Date[data.Date.length-1], data.Date[0]]);

			var xScale2 = d3.time.scale()
							.range([0+paddingH, w2-paddingH])
							.domain([data.Date[data.Date.length-1], data.Date[0]]);

			var xScale3 = d3.time.scale()
							.range([0+paddingH, w3-paddingH])
							.domain([data.Date[data.Date.length-1], data.Date[0]]);


			var yScale1 = d3.scale.linear()
							.domain([d3.min(data.PD) -25, d3.max(data.PD)])
							.range([h1-0.5*paddingV,0.5*paddingV]);

			var yScale2 = d3.scale.linear()
							.domain([d3.min(data.SUCmeanDelay) -15, d3.max(data.SUCmeanDelay) +15])
							.range([ h1 + h2 -0.5*paddingV, h2+ 0.5*paddingV]);

			var yScale3 = d3.scale.linear()
							.domain([d3.min(data.ReadedPlots) - 0*10000, d3.max(data.ReadedPlots) +10000])
							.range([ h1 + h2 + h3 - 0.5*paddingV, h2 + h3 + 0.5*paddingV]);


			//Define X axis
			var xAxis1 = d3.svg.axis()
							.scale(xScale1)
							.tickSize(-(h1-paddingV),0)
							.orient("bottom")
							.ticks(30);

			var xAxis2 = d3.svg.axis()
							.scale(xScale2)
							.tickSize(-(h1+h2-paddingV),0)
							.orient("bottom")
							.ticks(30);

			var xAxis3 = d3.svg.axis()
							.scale(xScale3)
							.tickSize(-(h1+h2+h3-paddingV),0)
							.orient("bottom")
							.ticks(30);

			var yAxis1 = d3.svg.axis()
							.scale(yScale1)
							.orient("left")
							.tickSize(-(w1-2*paddingH),0)
							.ticks(5);

			var yAxis2 = d3.svg.axis()
							.scale(yScale2)
							.orient("left")
							.tickSize(-(w1-2*paddingH),0)
							.ticks(5);

			var yAxis3 = d3.svg.axis()
							.scale(yScale3)
							.orient("left")
							.tickSize(-(w1-2*paddingH),0)
							.ticks(5);


			var line1 = d3.svg.line()
				.interpolate("linear")
				.x(function(d){return xScale1(d.Date); })
				.y(function(d){return yScale1(d.PD); });

			var line2 = d3.svg.line()
				.interpolate("linear")
				.x(function(d){return xScale2(d.Date); })
				.y(function(d){return yScale2(d.SUCmeanDelay); });

			var line3 = d3.svg.line()
				.interpolate("linear")
				.x(function(d){return xScale3(d.Date); })
				.y(function(d){return yScale3(d.ReadedPlots); });


			//Create X axis
			svg.append("g")
				.attr("class", "axis")
				.attr("transform", "translate(0," + (h1 - 0.5*paddingV) + ")")
				.call(xAxis1);

			svg.append("g")
				.attr("class", "axis")
				.attr("transform", "translate(0," + (h2 + h1 - 0.5*paddingV) + ")")
				.call(xAxis1);

			svg.append("g")
				.attr("class", "axis")
				.attr("transform", "translate(0," + (h2 + h1 +h3 - 0.5*paddingV) + ")")
				.call(xAxis1);

			//Create Y axis
			svg.append("g")
				.attr("class", "axis")
				.attr("transform", "translate(" + paddingH + ",0)")
				.call(yAxis1);

			svg.append("g")
				.attr("class", "axis")
				.attr("transform", "translate(" + paddingH + ",0)")
				.call(yAxis2);

			svg.append("g")
				.attr("class", "axis")
				.attr("transform", "translate(" + paddingH + ",0)")
				.call(yAxis3);

			


			svg.append("path")
				.attr("d", line1(data))
				.attr("class", "line1")
				.attr("stroke", "darkblue")
				.attr("fill", "none")
				.attr("stroke-width", "2")
				.attr("stroke-opacity","1");
//debugger;
			svg.append("path")
				.attr("d", line2(data))
				.attr("class", "line2")
				.attr("stroke", colorline2(data))
				.attr("fill", "none")
				.attr("stroke-width", "2")
				.attr("stroke-opacity","1");

			function colorline2(data){
				return "darkorange"
			}
			
			svg.append("path")
				.attr("d", line3(data))
				.attr("class", "line3")
				.attr("stroke", "darkred")
				.attr("fill", "none")
				.attr("stroke-width", "2")
				.attr("stroke-opacity","1");
		});
			//Create bars
			/*svg.selectAll("rect")
			   .data(dataset)
			   .enter()
			   .append("rect")
			   .attr("x", function(d, i) {
			   		return xScale1(i);
			   })
			   .attr("y", function(d) {
			   		return h1 - yScale1(d);
			   })
			   .attr("width", "1")
			   .attr("height", function(d) {
			   		return yScale1(d);
			   })
			   .attr("fill", function(d) {
					return "rgb(0, 0, " + (d * 10) + ")";
			   });

			//Create labels
			svg.selectAll("text")
			   .data(dataset)
			   .enter()
			   .append("text")
			   .text(function(d) {
			   		return d;
			   })
			   .attr("text-anchor", "middle")
			   .attr("x", function(d, i) {
			   		return xScale1(i) + xScale1.rangeBand() / 2;
			   })
			   .attr("y", function(d) {
			   		return h1 - yScale1(d) + 14;
			   })
			   .attr("font-family", "sans-serif")
			   .attr("font-size", "11px")
			   .attr("fill", "white");*/
			
		</script>
	</body>
</html>